<h2 mat-dialog-title>
  {{ isEditMode ? 'Editar Cliente' : 'Cadastrar Novo Cliente' }}
</h2>

<mat-dialog-content class="mat-typography">
  <div class="form-container-dialog-padding"> <p *ngIf="!isEditMode">Preencha os dados para cadastrar um novo cliente.</p>
    <p *ngIf="isEditMode">Altere os dados do cliente abaixo.</p>

    <form [formGroup]="clientForm" (ngSubmit)="onSubmit()" id="clientDialogForm">
      <mat-form-field appearance="outline" class="form-field-full-width">
        <mat-label>CPF</mat-label>
        <input matInput formControlName="cpf" placeholder="Ex: 00011122233" [readonly]="isEditMode">
        <mat-error *ngIf="cpf?.hasError('required')">CPF é obrigatório.</mat-error>
        <mat-error *ngIf="cpf?.hasError('pattern')">CPF deve conter 11 dígitos numéricos.</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="form-field-full-width">
        <mat-label>Nome</mat-label>
        <input matInput formControlName="first_name" placeholder="Ex: João">
        <mat-error *ngIf="first_name?.hasError('required')">Nome é obrigatório.</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="form-field-full-width">
        <mat-label>Sobrenome</mat-label>
        <input matInput formControlName="last_name" placeholder="Ex: Silva">
        <mat-error *ngIf="last_name?.hasError('required')">Sobrenome é obrigatório.</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="form-field-full-width">
        <mat-label>Email</mat-label>
        <input matInput type="email" formControlName="email" placeholder="Ex: email@exemplo.com">
        <mat-error *ngIf="email?.hasError('required')">Email é obrigatório.</mat-error>
        <mat-error *ngIf="email?.hasError('email')">Formato de email inválido.</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="form-field-full-width">
        <mat-label>Telefone</mat-label>
        <input matInput formControlName="phone" placeholder="Ex: (11) 98765-4321">
        <mat-error *ngIf="phone?.hasError('required')">Telefone é obrigatório.</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="form-field-full-width">
        <mat-label>CEP</mat-label>
        <input matInput formControlName="cep" placeholder="Ex: 01001000">
        <mat-error *ngIf="cep?.hasError('required')">CEP é obrigatório.</mat-error>
        <mat-error *ngIf="cep?.hasError('pattern')">CEP deve conter 8 dígitos numéricos.</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="form-field-full-width">
        <mat-label>Número (Endereço)</mat-label>
        <input matInput formControlName="number" placeholder="Ex: 123">
        <mat-error *ngIf="number?.hasError('required')">Número do endereço é obrigatório.</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="form-field-full-width">
        <mat-label>Complemento</mat-label>
        <input matInput formControlName="complement" placeholder="Ex: Apto 101, Bloco B">
      </mat-form-field>

      <mat-form-field appearance="outline" class="form-field-full-width">
        <mat-label>Como nos conheceu?</mat-label>
        <mat-select formControlName="how_found_us">
          <mat-option *ngFor="let option of howFoundUsOptions" [value]="option.value">
            {{ option.label }}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="how_found_us?.hasError('required')">Campo obrigatório.</mat-error>
      </mat-form-field>

      <div *ngIf="submissionSuccess" class="mensagem-sucesso" style="margin-top: 15px;">
        {{ isEditMode ? 'Cliente atualizado' : 'Cliente cadastrado' }} com sucesso!
      </div>
      <div *ngIf="submissionError" class="mensagem-erro" style="margin-top: 15px;">
        <strong>Erro:</strong> {{ submissionError }}
      </div>

    </form> </div> </mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-stroked-button type="button" (click)="onCancel()" *ngIf="isEditMode">
    Cancelar
  </button>
  <button mat-raised-button color="primary" type="submit" form="clientDialogForm" [disabled]="clientForm.invalid || isSubmitting">
    {{ isSubmitting ? 'Salvando...' : (isEditMode ? 'Atualizar Cliente' : 'Cadastrar Cliente') }}
  </button>
</mat-dialog-actions>
